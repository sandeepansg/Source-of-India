%% Configuration for SoI LaTeX Class v1.0
%% This file contains document-wide configuration settings

%% Amendment display settings
\showamendmentstrue     % Show amendment footnotes
\showomittedfalse       % Hide omitted articles by default

%% Custom amendment bracket styles (optional)
% \renewcommand{\amendmentopen}{\{}
% \renewcommand{\amendmentclose}{\}}

%% Typography customization
% \renewcommand{\partsize}{\huge}
% \renewcommand{\articlesize}{\large}

%% Spacing adjustments
\setlength{\parskip}{0.6em plus 0.1em minus 0.1em}
\setlength{\parindent}{0pt}

%% Footnote customization
\setlength{\footnotesep}{0.5em}
\renewcommand{\footnotesize}{\small}

%% Page break preferences
\clubpenalty=10000
\widowpenalty=10000
\raggedbottom

%% Development mode settings
\makeatletter
\if@draftmode
    % Additional debug information in draft mode
    \AtEndDocument{%
        \clearpage
        \section*{Document Statistics}
        \begin{tabular}{ll}
        Total Articles: & \thetotalarticles \\
        Total Amendments: & \thetotalamendments \\
        Omitted Articles: & \thetotalomitted \\
        \end{tabular}
    }
\fi
\makeatother

%% Table of contents depth
\setcounter{tocdepth}{3}

%% Custom colors (requires xcolor package if used)
% \RequirePackage{xcolor}
% \definecolor{amendmentcolor}{rgb}{0,0,0.8}

%% Custom commands for specific constitutional elements
\newcommand{\ArticleRef}[1]{Article~#1}
\newcommand{\PartRef}[1]{Part~#1}
\newcommand{\ScheduleRef}[1]{Schedule~#1}

%% Amendment citation standards
\newcommand{\ConstitutionAmendment}[3]{%
    Constitution (#1 Amendment) Act, #2, s.~#3%
}

%% Conditional compilation helpers
\newif\ifcompilepart
\newif\ifcompileschedules
\compileparttrue
\compileschedulestrue

%% Memory optimization for large documents
\setcounter{totalnumber}{50}
\setcounter{topnumber}{50}
\setcounter{bottomnumber}{50}
\renewcommand{\topfraction}{0.85}
\renewcommand{\bottomfraction}{0.85}
\renewcommand{\textfraction}{0.15}
\renewcommand{\floatpagefraction}{0.7}

%% Error handling and validation
\newcommand{\ValidateArticleNumber}[1]{%
    \ifnum#1<1\relax
        \ClassError{soi}{Invalid article number: #1}{Article numbers must be positive integers}%
    \fi%
    \ifnum#1>395\relax
        \ClassWarning{soi}{Article number #1 exceeds known range}%
    \fi%
}

%% Cross-reference formatting
\newcommand{\xref}[1]{\hyperref[#1]{#1}}

%% Special formatting for constitutional quotes
\newenvironment{constitutionalquote}
    {\begin{quote}\itshape}
    {\end{quote}}

%% Amendment history tracking (optional)
\newcommand{\AmendmentHistory}[1]{%
    % This could be expanded to track complete amendment history
    % Currently just passes through to standard Amendment command
    \Amendment{#1}%
}

%% Debug mode helpers
\newcommand{\DebugInfo}[1]{%
    \if@draftmode
        \marginpar{\tiny\textcolor{red}{#1}}%
    \fi
}

%% Custom page styles for different sections
\RequirePackage{fancyhdr}

\fancypagestyle{partpage}{%
    \fancyhf{}%
    \fancyfoot[C]{\thepage}%
    \renewcommand{\headrulewidth}{0pt}%
}

\fancypagestyle{schedulepage}{%
    \fancyhf{}%
    \fancyhead[L]{\small\leftmark}%
    \fancyhead[R]{\small\itshape Schedules}%
    \fancyfoot[C]{\thepage}%
}

%% Enhanced page management settings
\RequirePackage{needspace}

%% Prevent page breaks within constitutional elements
\newcommand{\keepwithfootnote}[1]{%
    \needspace{3\baselineskip}%
    #1%
}

%% Enhanced footnote management for amendments
\makeatletter
\renewcommand\@makefntext[1]{%
    \parindent 1em%
    \noindent
    \hb@xt@1.8em{\hss\@makefnmark}%
    \raggedright #1%
}
\makeatother

%% Ensure amendments and their footnotes stay together
\newcommand{\amendmentwithfootnote}[2]{%
    \needspace{2\baselineskip}%
    #1\footnote{#2}%
}

%% Page layout optimization for text-footnote balance
\RequirePackage{geometry}
\geometry{
    footnotesep=0.7em,
    marginparsep=0.5em
}

%% Enhanced list formatting for constitutional elements
\RequirePackage{enumitem}
\setlist{nosep, leftmargin=2em}
\setlist[enumerate,1]{label=(\arabic*)}
\setlist[enumerate,2]{label=(\alph*)}
\setlist[enumerate,3]{label=(\roman*)}

%% Special handling for long constitutional provisions
\newenvironment{longprovision}
    {\par\needspace{4\baselineskip}\begin{adjustwidth}{1em}{1em}\small}
    {\end{adjustwidth}\par}

%% Enhanced amendment tracking
\newcounter{amendmentcount}
\newcommand{\trackamendment}[1]{%
    \stepcounter{amendmentcount}%
    \label{amendment:\theamendmentcount}%
}

%% Ensure proper spacing around constitutional elements
\newcommand{\constitutionalspacing}{%
    \setlength{\parskip}{0.6em plus 0.2em minus 0.1em}%
    \setlength{\itemsep}{0.3em plus 0.1em minus 0.1em}%
}

%% Apply constitutional spacing
\AtBeginDocument{\constitutionalspacing}

%% End of configuration